{
  "vulns": [
    {
      "id": "ASB-A-184963385",
      "details": "In beginWrite and beginRead  of MessageQueueBase.h, there is a possible out of bounds write due to improper input validation. This could lead to local escalation of privilege with System execution privileges needed. User interaction is not needed for exploitation.",
      "aliases": [
        "A-184963385",
        "CVE-2021-0585"
      ],
      "modified": "2025-09-01T15:03:59.638214Z",
      "published": "2021-07-01T00:00:00Z",
      "references": [
        {
          "type": "ADVISORY",
          "url": "https://source.android.com/security/bulletin/2021-07-01"
        },
        {
          "type": "FIX",
          "url": "https://android.googlesource.com/platform/system/libfmq/+/7f0e32bd77277a46759eb9f01a493b45c7e9a3c9"
        }
      ],
      "affected": [
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "8.1:0"
                },
                {
                  "fixed": "8.1:2021-07-01"
                }
              ]
            }
          ],
          "versions": [
            "8.1"
          ],
          "ecosystem_specific": {
            "spl": "2021-07-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/3f308c6acfcb65f393edbd6116b22b533ef326b2",
                "digest": {
                  "line_hashes": [
                    "300022660320167551308862749013558626121",
                    "254649352422238151419608266615740997635",
                    "53657500343593482583714925289490764735",
                    "292970735981558875510801691438496921814",
                    "250292387344981924642512342354457729211",
                    "339156788682527144629979745978484334149",
                    "271850609831749251151038958195363888005",
                    "288871552498701704663384623211518767190",
                    "61593552060179744651164239855191336885",
                    "92802034542751339213119156295249367201",
                    "168538043508961032340963671571992798762",
                    "42247331127913660586074889430481403667",
                    "79088654464790524357252826744186188969",
                    "112624877699840080183006125848811958253",
                    "12429203616456136708920844482689329677",
                    "181592415355305386570539476014158765742",
                    "317687778973974435522516822096999496081",
                    "40910131920625444190999795801859453116",
                    "302802101381875735461446465709124607644",
                    "178979752920340011727083479353157198063",
                    "216928357803509634681769277560485086209",
                    "107310925987573623907065954361058072137"
                  ],
                  "threshold": 0.9
                },
                "id": "ASB-A-184963385-0f71992c",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "beginRead",
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/3f308c6acfcb65f393edbd6116b22b533ef326b2",
                "digest": {
                  "function_hash": "25814852906500043335487120437247780942",
                  "length": 789
                },
                "id": "ASB-A-184963385-287fbee7",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "beginWrite",
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/3f308c6acfcb65f393edbd6116b22b533ef326b2",
                "digest": {
                  "function_hash": "1132215189128848320662267450900731733",
                  "length": 647
                },
                "id": "ASB-A-184963385-96422510",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "tests/msgq_test_client.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/3f308c6acfcb65f393edbd6116b22b533ef326b2",
                "digest": {
                  "line_hashes": [
                    "86464080605561577303249332346361936345",
                    "200842590254382353602991587513115428166",
                    "331990379976521815974052574618971388267"
                  ],
                  "threshold": 0.9
                },
                "id": "ASB-A-184963385-cb25342e",
                "signature_version": "v1",
                "signature_type": "Line"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/3f308c6acfcb65f393edbd6116b22b533ef326b2"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-184963385.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "9:0"
                },
                {
                  "fixed": "9:2021-07-01"
                }
              ]
            }
          ],
          "versions": [
            "9"
          ],
          "ecosystem_specific": {
            "spl": "2021-07-01",
            "vanir_signatures": [
              {
                "target": {
                  "function": "beginWrite",
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/c7d5f09188ed79704bcf740ec22a5f762ae3d941",
                "digest": {
                  "function_hash": "1132215189128848320662267450900731733",
                  "length": 647
                },
                "id": "ASB-A-184963385-1ce32c61",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/c7d5f09188ed79704bcf740ec22a5f762ae3d941",
                "digest": {
                  "line_hashes": [
                    "300022660320167551308862749013558626121",
                    "254649352422238151419608266615740997635",
                    "53657500343593482583714925289490764735",
                    "292970735981558875510801691438496921814",
                    "250292387344981924642512342354457729211",
                    "339156788682527144629979745978484334149",
                    "271850609831749251151038958195363888005",
                    "288871552498701704663384623211518767190",
                    "61593552060179744651164239855191336885",
                    "92802034542751339213119156295249367201",
                    "168538043508961032340963671571992798762",
                    "42247331127913660586074889430481403667",
                    "79088654464790524357252826744186188969",
                    "112624877699840080183006125848811958253",
                    "12429203616456136708920844482689329677",
                    "181592415355305386570539476014158765742",
                    "317687778973974435522516822096999496081",
                    "40910131920625444190999795801859453116",
                    "302802101381875735461446465709124607644",
                    "178979752920340011727083479353157198063",
                    "216928357803509634681769277560485086209",
                    "107310925987573623907065954361058072137"
                  ],
                  "threshold": 0.9
                },
                "id": "ASB-A-184963385-3b8caeb0",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "beginRead",
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/c7d5f09188ed79704bcf740ec22a5f762ae3d941",
                "digest": {
                  "function_hash": "25814852906500043335487120437247780942",
                  "length": 789
                },
                "id": "ASB-A-184963385-c77506cd",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "tests/msgq_test_client.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/c7d5f09188ed79704bcf740ec22a5f762ae3d941",
                "digest": {
                  "line_hashes": [
                    "86464080605561577303249332346361936345",
                    "200842590254382353602991587513115428166",
                    "331990379976521815974052574618971388267"
                  ],
                  "threshold": 0.9
                },
                "id": "ASB-A-184963385-cd3a437b",
                "signature_version": "v1",
                "signature_type": "Line"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/c7d5f09188ed79704bcf740ec22a5f762ae3d941"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-184963385.json"
          }
        },
        {
          "package": {
            "name": "platform/frameworks/av",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "10:0"
                },
                {
                  "fixed": "10:2021-07-01"
                }
              ]
            }
          ],
          "versions": [
            "10"
          ],
          "ecosystem_specific": {
            "spl": "2021-07-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "media/bufferpool/2.0/BufferStatus.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/frameworks/av/+/b0e09634903a73908b84361564215a79f1f6bdb1",
                "id": "ASB-A-184963385-dd1f2afc",
                "match_only_versions": [
                  "10"
                ],
                "digest": {
                  "line_hashes": [
                    "320969485079306349290330415981021442138",
                    "15124061242647060976983700580520203911",
                    "57939858987354665103425629076016381741"
                  ],
                  "threshold": 0.9
                },
                "signature_version": "v1",
                "signature_type": "Line"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/frameworks/av/+/b0e09634903a73908b84361564215a79f1f6bdb1"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-184963385.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "10:0"
                },
                {
                  "fixed": "10:2021-07-01"
                }
              ]
            }
          ],
          "versions": [
            "10"
          ],
          "ecosystem_specific": {
            "spl": "2021-07-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4dfdd1b76d0c3dc95bf0cbc7fb815e7216fa1f94",
                "digest": {
                  "line_hashes": [
                    "227302126195856825414451364477443874828",
                    "247158300231320596903620852611188645202",
                    "300022660320167551308862749013558626121",
                    "254649352422238151419608266615740997635",
                    "53657500343593482583714925289490764735",
                    "292970735981558875510801691438496921814",
                    "250292387344981924642512342354457729211",
                    "339156788682527144629979745978484334149",
                    "271850609831749251151038958195363888005",
                    "288871552498701704663384623211518767190",
                    "61593552060179744651164239855191336885",
                    "92802034542751339213119156295249367201",
                    "168538043508961032340963671571992798762",
                    "42247331127913660586074889430481403667",
                    "79088654464790524357252826744186188969",
                    "112624877699840080183006125848811958253",
                    "12429203616456136708920844482689329677",
                    "181592415355305386570539476014158765742",
                    "317687778973974435522516822096999496081",
                    "40910131920625444190999795801859453116",
                    "302802101381875735461446465709124607644",
                    "178979752920340011727083479353157198063",
                    "216928357803509634681769277560485086209",
                    "107310925987573623907065954361058072137"
                  ],
                  "threshold": 0.9
                },
                "id": "ASB-A-184963385-57eb5add",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "beginRead",
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4dfdd1b76d0c3dc95bf0cbc7fb815e7216fa1f94",
                "digest": {
                  "function_hash": "25814852906500043335487120437247780942",
                  "length": 789
                },
                "id": "ASB-A-184963385-8e061e22",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "tests/msgq_test_client.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4dfdd1b76d0c3dc95bf0cbc7fb815e7216fa1f94",
                "digest": {
                  "line_hashes": [
                    "304724205008051771174038391144772804717",
                    "9431047653358304405740597187304665060",
                    "330652359866260078959063697446346183067",
                    "63834971338319188425783480848334362287",
                    "86464080605561577303249332346361936345",
                    "200842590254382353602991587513115428166",
                    "331990379976521815974052574618971388267"
                  ],
                  "threshold": 0.9
                },
                "id": "ASB-A-184963385-a79b1f2d",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "SetUp",
                  "file": "tests/msgq_test_client.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4dfdd1b76d0c3dc95bf0cbc7fb815e7216fa1f94",
                "digest": {
                  "function_hash": "213862884393298803354305101504209452764",
                  "length": 405
                },
                "id": "ASB-A-184963385-c98807db",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "beginWrite",
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4dfdd1b76d0c3dc95bf0cbc7fb815e7216fa1f94",
                "digest": {
                  "function_hash": "1132215189128848320662267450900731733",
                  "length": 647
                },
                "id": "ASB-A-184963385-d8febe24",
                "signature_version": "v1",
                "signature_type": "Function"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/4dfdd1b76d0c3dc95bf0cbc7fb815e7216fa1f94"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-184963385.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "11:0"
                },
                {
                  "fixed": "11:2021-07-01"
                }
              ]
            }
          ],
          "versions": [
            "11"
          ],
          "ecosystem_specific": {
            "spl": "2021-07-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4ed31d5a6c5c48a2f9fc3e812600093f81c33d27",
                "digest": {
                  "line_hashes": [
                    "300022660320167551308862749013558626121",
                    "254649352422238151419608266615740997635",
                    "53657500343593482583714925289490764735",
                    "292970735981558875510801691438496921814",
                    "250292387344981924642512342354457729211",
                    "339156788682527144629979745978484334149",
                    "271850609831749251151038958195363888005",
                    "288871552498701704663384623211518767190",
                    "61593552060179744651164239855191336885",
                    "92802034542751339213119156295249367201",
                    "168538043508961032340963671571992798762",
                    "42247331127913660586074889430481403667",
                    "79088654464790524357252826744186188969",
                    "112624877699840080183006125848811958253",
                    "12429203616456136708920844482689329677",
                    "181592415355305386570539476014158765742",
                    "317687778973974435522516822096999496081",
                    "40910131920625444190999795801859453116",
                    "302802101381875735461446465709124607644",
                    "178979752920340011727083479353157198063",
                    "216928357803509634681769277560485086209",
                    "107310925987573623907065954361058072137"
                  ],
                  "threshold": 0.9
                },
                "id": "ASB-A-184963385-11190517",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "beginRead",
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4ed31d5a6c5c48a2f9fc3e812600093f81c33d27",
                "digest": {
                  "function_hash": "25814852906500043335487120437247780942",
                  "length": 789
                },
                "id": "ASB-A-184963385-1183c25b",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "SetUp",
                  "file": "tests/msgq_test_client.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4ed31d5a6c5c48a2f9fc3e812600093f81c33d27",
                "digest": {
                  "function_hash": "213862884393298803354305101504209452764",
                  "length": 405
                },
                "id": "ASB-A-184963385-68b4fc85",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "tests/msgq_test_client.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4ed31d5a6c5c48a2f9fc3e812600093f81c33d27",
                "digest": {
                  "line_hashes": [
                    "304724205008051771174038391144772804717",
                    "9431047653358304405740597187304665060",
                    "330652359866260078959063697446346183067",
                    "63834971338319188425783480848334362287",
                    "86464080605561577303249332346361936345",
                    "200842590254382353602991587513115428166",
                    "331990379976521815974052574618971388267"
                  ],
                  "threshold": 0.9
                },
                "id": "ASB-A-184963385-c013d075",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "beginWrite",
                  "file": "include/fmq/MessageQueue.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/4ed31d5a6c5c48a2f9fc3e812600093f81c33d27",
                "digest": {
                  "function_hash": "1132215189128848320662267450900731733",
                  "length": 647
                },
                "id": "ASB-A-184963385-fe2e0e51",
                "signature_version": "v1",
                "signature_type": "Function"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/4ed31d5a6c5c48a2f9fc3e812600093f81c33d27"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-184963385.json"
          }
        }
      ],
      "schema_version": "1.7.3"
    },
    {
      "id": "ASB-A-321326147",
      "details": "In multiple functions of MessageQueueBase.h, there is a possible out of bounds write due to a race condition. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.",
      "aliases": [
        "A-321326147",
        "CVE-2024-31327"
      ],
      "modified": "2025-09-01T15:03:59.638214Z",
      "published": "2024-06-01T00:00:00Z",
      "references": [
        {
          "type": "ADVISORY",
          "url": "https://source.android.com/security/bulletin/2024-06-01"
        },
        {
          "type": "FIX",
          "url": "https://android.googlesource.com/platform/system/libfmq/+/79bbf4aeef4b254c52da670a972e22956c8c659d"
        }
      ],
      "affected": [
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "14-next:0"
                },
                {
                  "fixed": "14-next:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "14-next"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/db9028d6eead72c9cd45da48087ec6d5f1ac9c5a",
                "signature_version": "v1",
                "id": "ASB-A-321326147-b6da29fd",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/db9028d6eead72c9cd45da48087ec6d5f1ac9c5a",
                "signature_version": "v1",
                "id": "ASB-A-321326147-d833764a",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/db9028d6eead72c9cd45da48087ec6d5f1ac9c5a",
                "signature_version": "v1",
                "id": "ASB-A-321326147-eecf1aa8",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              }
            ],
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/db9028d6eead72c9cd45da48087ec6d5f1ac9c5a"
            ],
            "severity": "High",
            "types": [
              "EoP"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321326147.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "12:0"
                },
                {
                  "fixed": "12:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "12"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/af19e0ef034174afd794563552f91303fd9f1529",
                "signature_version": "v1",
                "id": "ASB-A-321326147-4c2650f1",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/af19e0ef034174afd794563552f91303fd9f1529",
                "signature_version": "v1",
                "id": "ASB-A-321326147-c7b1ad30",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/af19e0ef034174afd794563552f91303fd9f1529",
                "signature_version": "v1",
                "id": "ASB-A-321326147-eb5c74d7",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              }
            ],
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/af19e0ef034174afd794563552f91303fd9f1529"
            ],
            "severity": "High",
            "types": [
              "EoP"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321326147.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "12L:0"
                },
                {
                  "fixed": "12L:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "12L"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/b923a7c0d0d25de7b0c9ba7a7c2a3e917819d95a",
                "signature_version": "v1",
                "id": "ASB-A-321326147-71cda85e",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/b923a7c0d0d25de7b0c9ba7a7c2a3e917819d95a",
                "signature_version": "v1",
                "id": "ASB-A-321326147-99698b61",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/b923a7c0d0d25de7b0c9ba7a7c2a3e917819d95a",
                "signature_version": "v1",
                "id": "ASB-A-321326147-f0af7d31",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              }
            ],
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/b923a7c0d0d25de7b0c9ba7a7c2a3e917819d95a"
            ],
            "severity": "High",
            "types": [
              "EoP"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321326147.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "13:0"
                },
                {
                  "fixed": "13:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "13"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/050952bf5f9bd035e469ce005300115d563e524a",
                "signature_version": "v1",
                "id": "ASB-A-321326147-54886f13",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/050952bf5f9bd035e469ce005300115d563e524a",
                "signature_version": "v1",
                "id": "ASB-A-321326147-588489ff",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/050952bf5f9bd035e469ce005300115d563e524a",
                "signature_version": "v1",
                "id": "ASB-A-321326147-c0375658",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              }
            ],
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/050952bf5f9bd035e469ce005300115d563e524a"
            ],
            "severity": "High",
            "types": [
              "EoP"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321326147.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "14:0"
                },
                {
                  "fixed": "14:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "14"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/da080aa565f0cd1158bde3b8100dc73604959035",
                "signature_version": "v1",
                "id": "ASB-A-321326147-11822135",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/da080aa565f0cd1158bde3b8100dc73604959035",
                "signature_version": "v1",
                "id": "ASB-A-321326147-6cb18cc9",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/da080aa565f0cd1158bde3b8100dc73604959035",
                "signature_version": "v1",
                "id": "ASB-A-321326147-a76eed42",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              }
            ],
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/da080aa565f0cd1158bde3b8100dc73604959035"
            ],
            "severity": "High",
            "types": [
              "EoP"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321326147.json"
          }
        }
      ],
      "schema_version": "1.7.3"
    },
    {
      "id": "ASB-A-321341508",
      "details": "In availableToWriteBytes of MessageQueueBase.h, there is a possible out of bounds write due to an incorrect bounds check. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.",
      "aliases": [
        "A-321341508",
        "CVE-2024-31313"
      ],
      "modified": "2025-09-01T15:03:59.638214Z",
      "published": "2024-06-01T00:00:00Z",
      "references": [
        {
          "type": "ADVISORY",
          "url": "https://source.android.com/security/bulletin/2024-06-01"
        },
        {
          "type": "FIX",
          "url": "https://android.googlesource.com/platform/system/libfmq/+/79bbf4aeef4b254c52da670a972e22956c8c659d"
        }
      ],
      "affected": [
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "14-next:0"
                },
                {
                  "fixed": "14-next:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "14-next"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/db9028d6eead72c9cd45da48087ec6d5f1ac9c5a",
                "signature_version": "v1",
                "id": "ASB-A-321341508-b6da29fd",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/db9028d6eead72c9cd45da48087ec6d5f1ac9c5a",
                "signature_version": "v1",
                "id": "ASB-A-321341508-d833764a",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/db9028d6eead72c9cd45da48087ec6d5f1ac9c5a",
                "signature_version": "v1",
                "id": "ASB-A-321341508-eecf1aa8",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/db9028d6eead72c9cd45da48087ec6d5f1ac9c5a"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321341508.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "12:0"
                },
                {
                  "fixed": "12:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "12"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/af19e0ef034174afd794563552f91303fd9f1529",
                "signature_version": "v1",
                "id": "ASB-A-321341508-4c2650f1",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/af19e0ef034174afd794563552f91303fd9f1529",
                "signature_version": "v1",
                "id": "ASB-A-321341508-c7b1ad30",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/af19e0ef034174afd794563552f91303fd9f1529",
                "signature_version": "v1",
                "id": "ASB-A-321341508-eb5c74d7",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/af19e0ef034174afd794563552f91303fd9f1529"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321341508.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "12L:0"
                },
                {
                  "fixed": "12L:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "12L"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/b923a7c0d0d25de7b0c9ba7a7c2a3e917819d95a",
                "signature_version": "v1",
                "id": "ASB-A-321341508-71cda85e",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/b923a7c0d0d25de7b0c9ba7a7c2a3e917819d95a",
                "signature_version": "v1",
                "id": "ASB-A-321341508-99698b61",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/b923a7c0d0d25de7b0c9ba7a7c2a3e917819d95a",
                "signature_version": "v1",
                "id": "ASB-A-321341508-f0af7d31",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/b923a7c0d0d25de7b0c9ba7a7c2a3e917819d95a"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321341508.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "13:0"
                },
                {
                  "fixed": "13:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "13"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/050952bf5f9bd035e469ce005300115d563e524a",
                "signature_version": "v1",
                "id": "ASB-A-321341508-54886f13",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/050952bf5f9bd035e469ce005300115d563e524a",
                "signature_version": "v1",
                "id": "ASB-A-321341508-588489ff",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/050952bf5f9bd035e469ce005300115d563e524a",
                "signature_version": "v1",
                "id": "ASB-A-321341508-c0375658",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/050952bf5f9bd035e469ce005300115d563e524a"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321341508.json"
          }
        },
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "14:0"
                },
                {
                  "fixed": "14:2024-06-01"
                }
              ]
            }
          ],
          "versions": [
            "14"
          ],
          "ecosystem_specific": {
            "spl": "2024-06-01",
            "vanir_signatures": [
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/da080aa565f0cd1158bde3b8100dc73604959035",
                "signature_version": "v1",
                "id": "ASB-A-321341508-11822135",
                "digest": {
                  "line_hashes": [
                    "223300289963335374737942252888573102210",
                    "18488681837412616122657724577069121117",
                    "117125899055428656738178779745640830831",
                    "124740727282001485722438669538694109634",
                    "26754661951786742350714602196532112434",
                    "309930484527067763940979091410551508531",
                    "12256677282735441436613688363205428834",
                    "296149326157022037812024307966699756893",
                    "186726450763857558586092957778372274909",
                    "109017410997082114250456964558342449531"
                  ],
                  "threshold": 0.9
                },
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "availableToReadBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/da080aa565f0cd1158bde3b8100dc73604959035",
                "signature_version": "v1",
                "id": "ASB-A-321341508-6cb18cc9",
                "digest": {
                  "function_hash": "42176836157770431253731899450536067667",
                  "length": 132
                },
                "signature_type": "Function"
              },
              {
                "target": {
                  "function": "availableToWriteBytes",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/da080aa565f0cd1158bde3b8100dc73604959035",
                "signature_version": "v1",
                "id": "ASB-A-321341508-a76eed42",
                "digest": {
                  "function_hash": "152908095466554525151767292445838411466",
                  "length": 67
                },
                "signature_type": "Function"
              }
            ],
            "types": [
              "EoP"
            ],
            "severity": "High",
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/da080aa565f0cd1158bde3b8100dc73604959035"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/ASB-A-321341508.json"
          }
        }
      ],
      "schema_version": "1.7.3"
    },
    {
      "id": "PUB-A-244713317",
      "details": "In mapGrantorDescr of MessageQueueBase.h, there is a possible out of bounds write due to a missing bounds check. This could lead to local escalation of privilege with System execution privileges needed. User interaction is not needed for exploitation.",
      "aliases": [
        "A-244713317",
        "CVE-2022-20509"
      ],
      "modified": "2025-09-01T15:03:59.638214Z",
      "published": "2022-12-01T00:00:00Z",
      "references": [
        {
          "type": "ADVISORY",
          "url": "https://source.android.com/security/bulletin/2022-12-01"
        },
        {
          "type": "FIX",
          "url": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750"
        }
      ],
      "affected": [
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "13:0"
                },
                {
                  "fixed": "13:2022-12-01"
                }
              ]
            }
          ],
          "versions": [
            "13"
          ],
          "ecosystem_specific": {
            "spl": "2022-12-01",
            "vanir_signatures": [
              {
                "target": {
                  "function": "mapGrantorDescr",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "id": "PUB-A-244713317-21de4b3d",
                "match_only_versions": [
                  "13"
                ],
                "digest": {
                  "function_hash": "117994369638352159013783034520011204441",
                  "length": 879
                },
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "digest": {
                  "line_hashes": [
                    "67484995657003224955318954683180730890",
                    "310898135619990053173729018601956591364",
                    "82562672576624295606832928781752145722",
                    "36725436089181828859930790851667003023",
                    "36537868771495100586021896887413660187",
                    "87011936911745103665835706938036880629",
                    "74203923177464633021985632458672042363",
                    "232120882197160868675065607234827088113",
                    "78069824865304482173256466857155126712",
                    "336954736232264469877665266232841594303",
                    "228275800705197611028944624404120959376",
                    "60674949932139451340654658068829415064",
                    "36962446667510517575636443169051170416",
                    "108173863767492490064272401368814478119",
                    "104312944686749705961981356789070736522",
                    "9072896714428533508821147921062592111",
                    "261465247552439670129999891517903228293",
                    "306534388091778377153740092955299339871",
                    "222777944803476103632358237644215907481",
                    "120333051406497396466302931774170291948",
                    "181723559458669636099384865386688758950",
                    "233213332800372462651745112802777573976",
                    "223819842263929424046456982381302432566",
                    "155891071089090743361178927813790871412",
                    "205681270071692416687839269517531837545",
                    "133169719922426619010269612848792368066",
                    "162389189266637103071289445205663046488",
                    "243589448773824964924565870326528507338",
                    "303233067439603952722300616709136032989",
                    "229473394326643855915392727541527113426",
                    "298058828768244214432078093146135870483",
                    "96786393582123770462785018165781125774",
                    "322864226368143761391301362506668192057",
                    "210560327462933430521818671067756242952"
                  ],
                  "threshold": 0.9
                },
                "id": "PUB-A-244713317-2271c3ee",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "TEST_F",
                  "file": "tests/fmq_unit_tests.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "digest": {
                  "function_hash": "335445632229354888712475954829175856665",
                  "length": 216
                },
                "id": "PUB-A-244713317-4c890400",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "tests/fmq_unit_tests.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "digest": {
                  "line_hashes": [
                    "88394673729518826306805389435331654255",
                    "13861490509111225701570021441029735990",
                    "296169833032243481115851601427355571420",
                    "247889856614117105554911986368495120090",
                    "111263984072266053930282828466995813907",
                    "151979667787910445657057514611031764703",
                    "94973963445847237940897541065036454524",
                    "299899666474686650483558448134332789534",
                    "19057638552602960911340720082907008687",
                    "76042016039630806438120073358379163507",
                    "246733554737942011964557257519530184837",
                    "109966967881248564745159406551377700562"
                  ],
                  "threshold": 0.9
                },
                "id": "PUB-A-244713317-660aa7be",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "initMemory",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "digest": {
                  "function_hash": "331745186214309042994454776427126214799",
                  "length": 1770
                },
                "id": "PUB-A-244713317-e60a228e",
                "signature_version": "v1",
                "signature_type": "Function"
              }
            ],
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750"
            ],
            "severity": "Moderate",
            "types": [
              "EoP"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/PUB-A-244713317.json"
          }
        }
      ],
      "schema_version": "1.7.3"
    },
    {
      "id": "PUB-A-247092734",
      "details": "In MessageQueueBase of MessageQueueBase.h, there is a possible out of bounds read due to a missing bounds check. This could lead to local escalation of privilege with System execution privileges needed. User interaction is not needed for exploitation.",
      "aliases": [
        "A-247092734",
        "CVE-2022-20557"
      ],
      "modified": "2025-09-01T15:03:59.638214Z",
      "published": "2022-12-01T00:00:00Z",
      "references": [
        {
          "type": "ADVISORY",
          "url": "https://source.android.com/security/bulletin/2022-12-01"
        },
        {
          "type": "FIX",
          "url": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750"
        }
      ],
      "affected": [
        {
          "package": {
            "name": "platform/system/libfmq",
            "ecosystem": "Android"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "13:0"
                },
                {
                  "fixed": "13:2022-12-01"
                }
              ]
            }
          ],
          "versions": [
            "13"
          ],
          "ecosystem_specific": {
            "spl": "2022-12-01",
            "vanir_signatures": [
              {
                "target": {
                  "function": "mapGrantorDescr",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "id": "PUB-A-247092734-21de4b3d",
                "match_only_versions": [
                  "13"
                ],
                "digest": {
                  "function_hash": "117994369638352159013783034520011204441",
                  "length": 879
                },
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "digest": {
                  "line_hashes": [
                    "67484995657003224955318954683180730890",
                    "310898135619990053173729018601956591364",
                    "82562672576624295606832928781752145722",
                    "36725436089181828859930790851667003023",
                    "36537868771495100586021896887413660187",
                    "87011936911745103665835706938036880629",
                    "74203923177464633021985632458672042363",
                    "232120882197160868675065607234827088113",
                    "78069824865304482173256466857155126712",
                    "336954736232264469877665266232841594303",
                    "228275800705197611028944624404120959376",
                    "60674949932139451340654658068829415064",
                    "36962446667510517575636443169051170416",
                    "108173863767492490064272401368814478119",
                    "104312944686749705961981356789070736522",
                    "9072896714428533508821147921062592111",
                    "261465247552439670129999891517903228293",
                    "306534388091778377153740092955299339871",
                    "222777944803476103632358237644215907481",
                    "120333051406497396466302931774170291948",
                    "181723559458669636099384865386688758950",
                    "233213332800372462651745112802777573976",
                    "223819842263929424046456982381302432566",
                    "155891071089090743361178927813790871412",
                    "205681270071692416687839269517531837545",
                    "133169719922426619010269612848792368066",
                    "162389189266637103071289445205663046488",
                    "243589448773824964924565870326528507338",
                    "303233067439603952722300616709136032989",
                    "229473394326643855915392727541527113426",
                    "298058828768244214432078093146135870483",
                    "96786393582123770462785018165781125774",
                    "322864226368143761391301362506668192057",
                    "210560327462933430521818671067756242952"
                  ],
                  "threshold": 0.9
                },
                "id": "PUB-A-247092734-2271c3ee",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "TEST_F",
                  "file": "tests/fmq_unit_tests.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "digest": {
                  "function_hash": "335445632229354888712475954829175856665",
                  "length": 216
                },
                "id": "PUB-A-247092734-4c890400",
                "signature_version": "v1",
                "signature_type": "Function"
              },
              {
                "target": {
                  "file": "tests/fmq_unit_tests.cpp"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "digest": {
                  "line_hashes": [
                    "88394673729518826306805389435331654255",
                    "13861490509111225701570021441029735990",
                    "296169833032243481115851601427355571420",
                    "247889856614117105554911986368495120090",
                    "111263984072266053930282828466995813907",
                    "151979667787910445657057514611031764703",
                    "94973963445847237940897541065036454524",
                    "299899666474686650483558448134332789534",
                    "19057638552602960911340720082907008687",
                    "76042016039630806438120073358379163507",
                    "246733554737942011964557257519530184837",
                    "109966967881248564745159406551377700562"
                  ],
                  "threshold": 0.9
                },
                "id": "PUB-A-247092734-660aa7be",
                "signature_version": "v1",
                "signature_type": "Line"
              },
              {
                "target": {
                  "function": "initMemory",
                  "file": "include/fmq/MessageQueueBase.h"
                },
                "deprecated": false,
                "source": "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750",
                "digest": {
                  "function_hash": "331745186214309042994454776427126214799",
                  "length": 1770
                },
                "id": "PUB-A-247092734-e60a228e",
                "signature_version": "v1",
                "signature_type": "Function"
              }
            ],
            "fixes": [
              "https://android.googlesource.com/platform/system/libfmq/+/98f3a08b2fb44e7cff31c26007fbe9feaac11750"
            ],
            "severity": "Moderate",
            "types": [
              "EoP"
            ]
          },
          "database_specific": {
            "source": "https://storage.googleapis.com/android-osv/PUB-A-247092734.json"
          }
        }
      ],
      "schema_version": "1.7.3"
    }
  ]
}